/*! fpsmeter 0.3.1 - 2nd Oct 2017 | https://github.com/darsain/fpsmeter */
(function(e,k){function v(a,f){for(var l in f)try{a.style[l]=f[l]}catch(e){}return a}function D(a){return null==a?String(a):"object"===typeof a||"function"===typeof a?a instanceof e.NodeList&&"nodelist"||a instanceof e.HTMLCollection&&"htmlcollection"||Object.prototype.toString.call(a).match(/\s([a-z]+)/i)[1].toLowerCase():typeof a}function S(a,f){if("array"!==D(f))return-1;if(f.indexOf)return f.indexOf(a);for(var l=0,e=f.length;l<e;l++)if(f[l]===a)return l;return-1}function E(){var a=arguments,f;
for(f in a[1])if(a[1].hasOwnProperty(f))switch(D(a[1][f])){case "object":"object"===D(a[0][f])?E(a[0][f],a[1][f]):a[0][f]=E({},a[1][f]);break;case "array":a[0][f]=a[1][f].slice(0);break;default:a[0][f]=a[1][f]}return 2<a.length?E.apply(null,[a[0]].concat(Array.prototype.slice.call(a,2))):a[0]}function N(a){a=Math.round(255*a).toString(16);return 1===a.length?"0"+a:a}function T(a,f,l,e){if(a.addEventListener)a[e?"removeEventListener":"addEventListener"](f,l,!1);else if(a.attachEvent)a[e?"detachEvent":
"attachEvent"]("on"+f,l)}function F(a,f){function e(a,b,c,d){return y[0|a][Math.round(Math.min((b-c)/(d-c)*I,I))]}function R(){g.legend.fps!==q&&(g.legend.fps=q,g.legend[U]=q?c.labelFps:c.labelMs);J=q?b.fps:b.duration;g.count[U]=999<J?"999+":J.toFixed(99<J?0:c.decimals)}function V(){z=A();K<z-c.threshold&&(b.fps-=b.fps/Math.max(1,60*c.smoothing/c.interval),b.duration=1E3/b.fps);for(d=c.history;d--;)G[d]=0===d?b.fps:G[d-1],H[d]=0===d?b.duration:H[d-1];R();if(c.heat){if(w.length)for(d=w.length;d--;)w[d].el.style[h[w[d].name].heatOn]=
q?e(h[w[d].name].heatmap,b.fps,0,c.maxFps):e(h[w[d].name].heatmap,b.duration,c.threshold,0);if(g.graph&&h.column.heatOn)for(d=s.length;d--;)s[d].style[h.column.heatOn]=q?e(h.column.heatmap,G[d],0,c.maxFps):e(h.column.heatmap,H[d],c.threshold,0)}if(g.graph)for(p=0;p<c.history;p++)s[p].style.height=(q?G[p]?Math.round(O/c.maxFps*Math.min(G[p],c.maxFps)):0:H[p]?Math.round(O/c.threshold*Math.min(H[p],c.threshold)):0)+"px"}function L(){20>c.interval?(x=M(L),V()):(x=setTimeout(L,c.interval),P=M(V))}function W(a){a=
a||window.event;a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.returnValue=!1,a.cancelBubble=!0);b.toggle()}function X(){c.toggleOn&&T(g.container,c.toggleOn,W,1);a.removeChild(g.container)}function Y(){g.container&&X();h=F.theme[c.theme];y=h.compiledHeatmaps||[];if(!y.length&&h.heatmaps.length){for(p=0;p<h.heatmaps.length;p++)for(y[p]=[],d=0;d<=I;d++){var b=y[p],f=d,e;e=0.33/I*d;var l=h.heatmaps[p].saturation,k=h.heatmaps[p].lightness,n=void 0,t=void 0,m=void 0,r=m=void 0,u=n=t=void 0,
u=void 0,m=0.5>=k?k*(1+l):k+l-k*l;0===m?e="#000":(r=2*k-m,t=(m-r)/m,e*=6,n=Math.floor(e),u=e-n,u*=m*t,0===n||6===n?(n=m,t=r+u,m=r):1===n?(n=m-u,t=m,m=r):2===n?(n=r,t=m,m=r+u):3===n?(n=r,t=m-u):4===n?(n=r+u,t=r):(n=m,t=r,m-=u),e="#"+N(n)+N(t)+N(m));b[f]=e}h.compiledHeatmaps=y}g.container=v(document.createElement("div"),h.container);g.count=g.container.appendChild(v(document.createElement("div"),h.count));g.legend=g.container.appendChild(v(document.createElement("div"),h.legend));g.graph=c.graph?g.container.appendChild(v(document.createElement("div"),
h.graph)):0;w.length=0;for(var q in g)g[q]&&h[q].heatOn&&w.push({name:q,el:g[q]});s.length=0;if(g.graph)for(g.graph.style.width=c.history*h.column.width+(c.history-1)*h.column.spacing+"px",d=0;d<c.history;d++)s[d]=g.graph.appendChild(v(document.createElement("div"),h.column)),s[d].style.position="absolute",s[d].style.bottom=0,s[d].style.right=d*h.column.width+d*h.column.spacing+"px",s[d].style.width=h.column.width+"px",s[d].style.height="0px";v(g.container,c);R();a.appendChild(g.container);g.graph&&
(O=g.graph.clientHeight);c.toggleOn&&("click"===c.toggleOn&&(g.container.style.cursor="pointer"),T(g.container,c.toggleOn,W))}"object"===D(a)&&a.nodeType===k&&(f=a,a=document.body);a||(a=document.body);var b=this,c=E({},F.defaults,f||{}),g={},s=[],h,y,I=100,w=[],Z=0,B=c.threshold,Q=0,K=A()-B,z,G=[],H=[],x,P,q="fps"===c.show,O,J,d,p;b.options=c;b.fps=0;b.duration=0;b.isPaused=0;b.tickStart=function(){Q=A()};b.tick=function(){z=A();Z=z-K;B+=(Z-B)/c.smoothing;b.fps=1E3/B;b.duration=Q<K?B:z-Q;K=z};b.pause=
function(){x&&(b.isPaused=1,clearTimeout(x),C(x),C(P),x=P=0);return b};b.resume=function(){x||(b.isPaused=0,L());return b};b.set=function(a,d){c[a]=d;q="fps"===c.show;-1!==S(a,$)&&Y();-1!==S(a,aa)&&v(g.container,c);return b};b.showDuration=function(){b.set("show","ms");return b};b.showFps=function(){b.set("show","fps");return b};b.toggle=function(){b.set("show",q?"ms":"fps");return b};b.hide=function(){b.pause();g.container.style.display="none";return b};b.show=function(){b.resume();g.container.style.display=
"block";return b};b.destroy=function(){b.pause();X();b.tick=b.tickStart=function(){}};Y();L()}var A;(function(){var a=e.performance;A=a&&(a.now||a.webkitNow)?a[a.now?"now":"webkitNow"].bind(a):function(){return+new Date}})();var C=e.cancelAnimationFrame||e.cancelRequestAnimationFrame,M=e.requestAnimationFrame;(function(){for(var a=["moz","webkit","o"],f=0,l=0,k=a.length;l<k&&!C;++l)M=(C=e[a[l]+"CancelAnimationFrame"]||e[a[l]+"CancelRequestAnimationFrame"])&&e[a[l]+"RequestAnimationFrame"];C||(M=function(a){var k=
A(),l=Math.max(0,16-(k-f));f=k+l;return e.setTimeout(function(){a(k+l)},l)},C=function(a){clearTimeout(a)})})();var U="string"===D(document.createElement("div").textContent)?"textContent":"innerText";F.extend=E;window.FPSMeter=F;F.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20,labelFps:"FPS",labelMs:"ms"};var $=["toggleOn",
"theme","heat","graph","history"],aa="position zIndex left top right bottom margin".split(" ")})(window);(function(e,k,v){k.theme={};e=k.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",
textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};k.theme.dark=k.extend({},e,{heatmaps:[{saturation:0.8,lightness:0.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}});k.theme.light=k.extend({},e,{heatmaps:[{saturation:0.5,lightness:0.5}],
container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}});k.theme.colorful=k.extend({},e,{heatmaps:[{saturation:0.5,lightness:0.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}});k.theme.transparent=
k.extend({},e,{heatmaps:[{saturation:0.8,lightness:0.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:0.5}})})(window,FPSMeter);
